# 성능 개선에 실패한 결과들
## Catboost vs Tabnet
- 테이블 형태의 정형 데이터로 예측하는데 사용한 두가지 방법
- Crop과 Disease를 예측하는데는 Catboost가 뛰어났고 Risk를 예측하는데는 Tabnet이 더 뛰어난 결과
- 하지만 Risk 예측의 측면에서는 F1 score가 앙상블에 적합하지 않을 정도로 떨어졌음(데이터 문제로 모델을 단순 조합하였기에 사용불가)
- 결과적으로 Catboost의 Crop과 Disease 결과만 앙상블로 사용

## Big Transfer 모델
- 기본적으로 선택한 모델. 준수한 성능을 보일거라 예측
- 다양한 크기의 pretrained 모델을 테스트 해봄
- 우선, timm 라이브러리에서 제공해주는 1K imagenet에 fine-tuning한 모델들은 모두 낮은 성능을 보임. fine-tuning과정에서 식물과 병변을 구분하기 위한 feature 변별 능력이 약화된 게 아닌가 추측함
- 기존에는 224x224 이미지 사이즈에서 훈련되었기에 이 크기에 이미지를 테스트하였고, 384x384 이미지 사이즈에서도 테스트 해봄. 224x224 크기에서 낮은 성능. 특히 병변을 판별하기 위한 해상도가 너무 낮았던 문제가 아닐까 추측.
- 다양한 깊이와 넓이의 모델을 테스트 함. GPU 메모리의 한계로 전반적인 탐색은 불가능했으나, 이번 과제에서는 모델의 깊이보다 넓이가 더 중요한 것을 확인함.
- 비교 모델: resnetv2_50x3_bitm_in21k vs resnetv2_101x1_bitm_in21k (timm 라이브러리에서의 대표 명칭)
- 아마도 매우 비슷한 모습의 crop, disease, risk 변별을 위해서는 매우 저수준의 특징 추출이 중요한게 아니었을까 추측. 혹은 단일 base에서 3가지 변별과제를 수행하기에는 넓이가 충분치 않았을 가능성 존재.
- 이를 검증하기 위해 단일 classification 모델로 변경하였음에도 비슷한 결과 획득.

## Cait 모델
- 기본 베이스는 Big Transfer에서 pretrained된 모델을 사용하는 것이었고 이는 CNN 기반 모델
- 병해 부분은 크기가 작고, 점 형태를 띄고 있는 부분 또한 있기에, patch를 사용하는 transformer 기반 모델이 효과가 좋지 않을까 생각
- 간단한 리서치 후, Cait 모델이 속도와 성능 측면에서 적합하다고 여겨져 선택
- 속도 측면에서 기존 모델보다 2배 이상 느림. 성능 측면에서도 부족한 결과

## Augmentation 방법
- 기본적으로 많은 변화는 주지 않으려 했음
- 다만, 데이터에 측정시간이 기록되어 있고, 이를 토대로 밝기 변화를 주고자 했음. 이때 contrast도 함께 변화를 주었는데, contrast의 변경은 성능을 낮추는 결과
- Cutmix와 같은 방법은 투입되는 이미지의 크기가 축소되고, 이는 모델이 변별하기 어려운 사이즈라는 것이 위의 이미지 사이즈와 관련된 실험에서 확인하였기에 제외함
- 다만, Mixup은 이미지 크기에 변화가 없이 시도할 수 있는 방법이었는데, 결과적으로 성능이 감소한 결과.

## 훈련 데이터 샘플링 방법
- WeightedRandomSampler 을 통해서 상대적으로 빈약한 데이터를 좀더 많이 넣는 방법을 시도. 하지만 비율을 어떻게 조절하든, 성능 감소로 이어짐.


#### 코드에 대해서 별도로 설명하지는 않습니다.
